---
title: Руководство по API
sidebar_position: 2
toc_min_heading_level: 3
toc_max_heading_level: 4
---

<!--
    The content below is simply an automatic conversion from the OpenAPI spec https://api.adguard-dns.io/static/swagger/openapi.json to markdown using https://swagger-markdown-ui.netlify.app/.

    If you want to change it, ask the developers to change the OpenAPI spec.
-->

Эта статья содержит документацию для [AdGuard DNS API](private-dns/api/overview.md). Полный список изменений AdGuard DNS API можно найти [на этой странице](private-dns/api/changelog.md).

## Current version: 1.9

### /oapi/v1/account/limits

#### GET

##### Что делает

Получает лимиты аккаунта

##### Ответы

| Код | Описание                      |
| --- | ----------------------------- |
| 200 | Информация о лимитах аккаунта |

### /oapi/v1/dedicated_addresses/ipv4

#### GET

##### Что делает

Перечисляет выделенные IPv4-адреса

##### Ответы

| Код | Описание                       |
| --- | ------------------------------ |
| 200 | Список выделенных IPv4-адресов |

#### POST

##### Что делает

Выделяет новый IPv4

##### Ответы

| Код | Описание                                    |
| --- | ------------------------------------------- |
| 200 | Новый IPv4 успешно выделен                  |
| 429 | Количество выделенных IPv4 достигло предела |

### /oapi/v1/devices

#### GET

##### Что делает

Перечисляет устройства

##### Ответы

| Код | Описание         |
| --- | ---------------- |
| 200 | Список устройств |

#### POST

##### Что делает

Создаёт новое устройство

##### Ответы

| Код | Описание                              |
| --- | ------------------------------------- |
| 200 | Устройство создано                    |
| 400 | Ошибка проверки                       |
| 429 | Количество устройств достигло предела |

### /oapi/v1/devices/{device_id}

#### DELETE

##### Что делает

Удаляет устройство

##### Параметры

| Имя       | Расположен в | Описание | Обязательно | Схема  |
| --------- | ------------ | -------- | ----------- | ------ |
| device_id | path         |          | Да          | string |

##### Ответы

| Код | Описание              |
| --- | --------------------- |
| 200 | Устройство удалено    |
| 404 | Устройство не найдено |

#### GET

##### Что делает

Получает существующее устройство по ID

##### Параметры

| Имя       | Расположен в | Описание | Обязательно | Схема  |
| --------- | ------------ | -------- | ----------- | ------ |
| device_id | path         |          | Да          | string |

##### Ответы

| Код | Описание                 |
| --- | ------------------------ |
| 200 | Информация об устройстве |
| 404 | Устройство не найдено    |

#### PUT

##### Что делает

Обновляет существующее устройство

##### Параметры

| Имя       | Расположен в | Описание | Обязательно | Схема  |
| --------- | ------------ | -------- | ----------- | ------ |
| device_id | path         |          | Да          | string |

##### Ответы

| Код | Описание              |
| --- | --------------------- |
| 200 | Устройство обновлено  |
| 400 | Ошибка проверки       |
| 404 | Устройство не найдено |

### /oapi/v1/devices/{device_id}/dedicated_addresses

#### GET

##### Что делает

Список выделенных адресов IPv4 и IPv6 для устройства

##### Параметры

| Имя       | Расположен в | Описание | Обязательно | Схема  |
| --------- | ------------ | -------- | ----------- | ------ |
| device_id | path         |          | Да          | string |

##### Ответы

| Код | Описание               |
| --- | ---------------------- |
| 200 | Выделенные IPv4 и IPv6 |

### /oapi/v1/devices/{device_id}/dedicated_addresses/ipv4

#### DELETE

##### Что делает

Отвязать выделенный IPv4 от устройства

##### Параметры

| Имя       | Расположен в | Описание | Обязательно | Схема  |
| --------- | ------------ | -------- | ----------- | ------ |
| device_id | path         |          | Да          | string |

##### Ответы

| Код | Описание                                      |
| --- | --------------------------------------------- |
| 200 | Выделенный IPv4 успешно отвязан от устройства |
| 404 | Устройство или адрес не найдены               |

#### POST

##### Что делает

Привязать выделенный IPv4 к устройству

##### Параметры

| Имя       | Расположен в | Описание | Обязательно | Схема  |
| --------- | ------------ | -------- | ----------- | ------ |
| device_id | path         |          | Да          | string |

##### Ответы

| Код | Описание                                                |
| --- | ------------------------------------------------------- |
| 200 | Выделенный IPv4 успешно привязан к устройству           |
| 400 | Ошибка проверки                                         |
| 404 | Устройство или адрес не найдены                         |
| 429 | Количество привязанных выделенных IPv4 достигло предела |

### /oapi/v1/devices/{device_id}/doh.mobileconfig

#### GET

##### Что делает

Получает файл DNS-over-HTTPS .mobileconfig.

##### Параметры

| Имя                     | Расположен в | Описание                                                                                   | Обязательно | Схема      |
| ----------------------- | ------------ | ------------------------------------------------------------------------------------------ | ----------- | ---------- |
| device_id               | path         |                                                                                            | Да          | string     |
| exclude_wifi_networks | query        | Перечислите сети Wi-Fi по их SSID, для которых вы хотите отключить AdGuard DNS             | Нет         | [ string ] |
| exclude_domain          | query        | Перечислите домены, которые будут использовать DNS-серверы по умолчанию вместо AdGuard DNS | Нет         | [ string ] |

##### Ответы

| Код | Описание                   |
| --- | -------------------------- |
| 200 | Файл DNS-over-HTTPS .plist |
| 404 | Устройство не найдено      |

### /oapi/v1/devices/{device_id}/doh_password/reset

#### PUT

##### Что делает

Создайте и установите новый пароль DNS-over-HTTPS

##### Параметры

| Имя       | Расположен в | Описание | Обязательно | Схема  |
| --------- | ------------ | -------- | ----------- | ------ |
| device_id | path         |          | Да          | string |

##### Ответы

| Код | Описание                              |
| --- | ------------------------------------- |
| 200 | Пароль DNS-over-HTTPS успешно сброшен |
| 404 | Устройство не найдено                 |

### /oapi/v1/devices/{device_id}/dot.mobileconfig

#### GET

##### Что делает

Получает файл DNS-over-TLS .mobileconfig.

##### Параметры

| Имя                     | Расположен в | Описание                                                                                   | Обязательно | Схема      |
| ----------------------- | ------------ | ------------------------------------------------------------------------------------------ | ----------- | ---------- |
| device_id               | path         |                                                                                            | Да          | string     |
| exclude_wifi_networks | query        | Перечислите сети Wi-Fi по их SSID, для которых вы хотите отключить AdGuard DNS             | Нет         | [ string ] |
| exclude_domain          | query        | Перечислите домены, которые будут использовать DNS-серверы по умолчанию вместо AdGuard DNS | Нет         | [ string ] |

##### Ответы

| Код | Описание                   |
| --- | -------------------------- |
| 200 | Файл DNS-over-HTTPS .plist |
| 404 | Устройство не найдено      |

### /oapi/v1/devices/{device_id}/settings

#### PUT

##### Что делает

Обновляет настройки устройства

##### Параметры

| Имя       | Расположен в | Описание | Обязательно | Схема  |
| --------- | ------------ | -------- | ----------- | ------ |
| device_id | path         |          | Да          | string |

##### Ответы

| Код | Описание                       |
| --- | ------------------------------ |
| 200 | Настройки устройства обновлены |
| 400 | Ошибка проверки                |
| 404 | Устройство не найдено          |

### /oapi/v1/dns_servers

#### GET

##### Что делает

Перечисляет DNS-серверы, принадлежащие пользователю.

##### Описание

Перечисляет DNS-серверы, принадлежащие пользователю. По умолчанию есть как минимум один сервер.

##### Ответы

| Код | Описание            |
| --- | ------------------- |
| 200 | Список DNS-серверов |

#### POST

##### Что делает

Создаёт новый DNS-сервер

##### Описание

Создаёт новый DNS-сервер. Вы можете установить собственные настройки, в противном случае DNS-сервер будет создан с настройками по умолчанию.

##### Ответы

| Код | Описание                                 |
| --- | ---------------------------------------- |
| 200 | DNS-сервер создан                        |
| 400 | Ошибка проверки                          |
| 429 | Количество DNS-серверов достигло предела |

### /oapi/v1/dns_servers/{dns_server_id}

#### DELETE

##### Что делает

Удаляет DNS-сервер

##### Описание

Удаляет DNS-сервер. Все устройства, подключённые к этому DNS-серверу, будут перемещены на DNS-сервер по умолчанию. Удалять DNS-сервер по умолчанию запрещено.

##### Параметры

| Имя             | Расположен в | Описание | Обязательно | Схема  |
| --------------- | ------------ | -------- | ----------- | ------ |
| dns_server_id | path         |          | Да          | string |

##### Ответы

| Код | Описание             |
| --- | -------------------- |
| 200 | DNS-сервер удалён    |
| 404 | DNS-сервер не найден |

#### GET

##### Что делает

Получает существующий DNS-сервер по ID

##### Параметры

| Имя             | Расположен в | Описание | Обязательно | Схема  |
| --------------- | ------------ | -------- | ----------- | ------ |
| dns_server_id | path         |          | Да          | string |

##### Ответы

| Код | Описание                 |
| --- | ------------------------ |
| 200 | Информация о DNS-сервере |
| 404 | DNS-сервер не найден     |

#### PUT

##### Что делает

Обновляет существующий DNS-сервер

##### Параметры

| Имя             | Расположен в | Описание | Обязательно | Схема  |
| --------------- | ------------ | -------- | ----------- | ------ |
| dns_server_id | path         |          | Да          | string |

##### Ответы

| Код | Описание             |
| --- | -------------------- |
| 200 | DNS-сервер обновлён  |
| 400 | Ошибка проверки      |
| 404 | DNS-сервер не найден |

### /oapi/v1/dns_servers/{dns_server_id}/settings

#### PUT

##### Что делает

Обновляет настройки DNS-сервера

##### Параметры

| Имя             | Расположен в | Описание | Обязательно | Схема  |
| --------------- | ------------ | -------- | ----------- | ------ |
| dns_server_id | path         |          | Да          | string |

##### Ответы

| Код | Описание                        |
| --- | ------------------------------- |
| 200 | Настройки DNS-сервера обновлены |
| 400 | Ошибка проверки                 |
| 404 | DNS-сервер не найден            |

### /oapi/v1/filter_lists

#### GET

##### Что делает

Получает списки фильтров

##### Ответы

| Код | Описание        |
| --- | --------------- |
| 200 | Список фильтров |

### /oapi/v1/oauth_token

#### POST

##### Что делает

Генерирует токен доступа и продлеваемый токен

##### Ответы

| Код | Описание                                                                        |
| --- | ------------------------------------------------------------------------------- |
| 200 | Выдан токен доступа                                                             |
| 400 | Отсутствуют обязательные параметры                                              |
| 401 | Предоставлены недействительные учётные данные, токен MFA или продлеваемый токен |

null

### /oapi/v1/query_log

#### DELETE

##### Что делает

Очищает журнал запросов

##### Ответы

| Код | Описание                   |
| --- | -------------------------- |
| 202 | Журнал запросов был очищен |

#### GET

##### Что делает

Получает журнал запросов

##### Параметры

| Имя                | Расположен в | Описание                                                                     | Обязательно | Схема                                               |
| ------------------ | ------------ | ---------------------------------------------------------------------------- | ----------- | --------------------------------------------------- |
| time_from_millis | query        | Время от в миллисекундах (включительно)                                      | Да          | long                                                |
| time_to_millis   | query        | Время до в миллисекундах (включительно)                                      | Да          | long                                                |
| devices            | query        | Фильтровать по устройствам                                                   | Нет         | [ string ]                                          |
| countries          | query        | Фильтровать по странам                                                       | Нет         | [ string ]                                          |
| companies          | query        | Фильтровать по компаниям                                                     | Нет         | [ string ]                                          |
| statuses           | query        | Фильтровать по статусам                                                      | Нет         | [ [FilteringActionStatus](#FilteringActionStatus) ] |
| categories         | query        | Фильтровать по категориям                                                    | Нет         | [ [CategoryType](#CategoryType) ]                   |
| search             | query        | Фильтровать по доменному имени                                               | Нет         | string                                              |
| limit              | query        | Ограничить количество возвращаемых записей                                   | Нет         | integer                                             |
| cursor             | query        | Курсорная пагинация. Используйте курсор из ответа для разбивки по страницам. | Нет         | string                                              |

##### Ответы

| Код | Описание        |
| --- | --------------- |
| 200 | Журнал запросов |

### /oapi/v1/revoke_token

#### POST

##### Что делает

Отзывает продлеваемый токен

##### Параметры

| Имя           | Расположен в | Описание           | Обязательно | Схема  |
| ------------- | ------------ | ------------------ | ----------- | ------ |
| refresh_token | query        | Продлеваемый токен | Да          | string |

##### Ответы

| Код | Описание                   |
| --- | -------------------------- |
| 200 | Продлеваемый токен отозван |

null

### /oapi/v1/stats/categories

#### GET

##### Что делает

Получает статистику категорий

##### Параметры

| Имя                | Расположен в | Описание                                | Обязательно | Схема      |
| ------------------ | ------------ | --------------------------------------- | ----------- | ---------- |
| time_from_millis | query        | Время от в миллисекундах (включительно) | Да          | long       |
| time_to_millis   | query        | Время до в миллисекундах (включительно) | Да          | long       |
| devices            | query        | Фильтровать по устройствам              | Нет         | [ string ] |
| countries          | query        | Фильтровать по странам                  | Нет         | [ string ] |

##### Ответы

| Код | Описание                          |
| --- | --------------------------------- |
| 200 | Получена статистика по категориям |
| 400 | Ошибка проверки                   |

### /oapi/v1/stats/companies

#### GET

##### Что делает

Получает статистику компаний

##### Параметры

| Имя                | Расположен в | Описание                                | Обязательно | Схема      |
| ------------------ | ------------ | --------------------------------------- | ----------- | ---------- |
| time_from_millis | query        | Время от в миллисекундах (включительно) | Да          | long       |
| time_to_millis   | query        | Время до в миллисекундах (включительно) | Да          | long       |
| devices            | query        | Фильтровать по устройствам              | Нет         | [ string ] |
| countries          | query        | Фильтровать по странам                  | Нет         | [ string ] |

##### Ответы

| Код | Описание                         |
| --- | -------------------------------- |
| 200 | Получена статистика по компаниям |
| 400 | Ошибка проверки                  |

### /oapi/v1/stats/companies/detailed

#### GET

##### Что делает

Получает подробную статистику компаний

##### Параметры

| Имя                | Расположен в | Описание                                | Обязательно | Схема      |
| ------------------ | ------------ | --------------------------------------- | ----------- | ---------- |
| time_from_millis | query        | Время от в миллисекундах (включительно) | Да          | long       |
| time_to_millis   | query        | Время до в миллисекундах (включительно) | Да          | long       |
| devices            | query        | Фильтровать по устройствам              | Нет         | [ string ] |
| countries          | query        | Фильтровать по странам                  | Нет         | [ string ] |
| cursor             | query        | Курсорная пагинация                     | Нет         | string     |

##### Ответы

| Код | Описание                                   |
| --- | ------------------------------------------ |
| 200 | Получена подробная статистика по компаниям |
| 400 | Ошибка проверки                            |

### /oapi/v1/stats/countries

#### GET

##### Что делает

Получает статистику по странам

##### Параметры

| Имя                | Расположен в | Описание                                | Обязательно | Схема      |
| ------------------ | ------------ | --------------------------------------- | ----------- | ---------- |
| time_from_millis | query        | Время от в миллисекундах (включительно) | Да          | long       |
| time_to_millis   | query        | Время до в миллисекундах (включительно) | Да          | long       |
| devices            | query        | Фильтровать по устройствам              | Нет         | [ string ] |
| countries          | query        | Фильтровать по странам                  | Нет         | [ string ] |

##### Ответы

| Код | Описание                       |
| --- | ------------------------------ |
| 200 | Получена статистика по странам |
| 400 | Ошибка проверки                |

### /oapi/v1/stats/devices

#### GET

##### Что делает

Получает статистику по устройствам

##### Параметры

| Имя                | Расположен в | Описание                                | Обязательно | Схема      |
| ------------------ | ------------ | --------------------------------------- | ----------- | ---------- |
| time_from_millis | query        | Время от в миллисекундах (включительно) | Да          | long       |
| time_to_millis   | query        | Время до в миллисекундах (включительно) | Да          | long       |
| devices            | query        | Фильтровать по устройствам              | Нет         | [ string ] |
| countries          | query        | Фильтровать по странам                  | Нет         | [ string ] |

##### Ответы

| Код | Описание                           |
| --- | ---------------------------------- |
| 200 | Получена статистика по устройствам |
| 400 | Ошибка проверки                    |

### /oapi/v1/stats/domains

#### GET

##### Что делает

Получает статистику по доменам

##### Параметры

| Имя                | Расположен в | Описание                                | Обязательно | Схема      |
| ------------------ | ------------ | --------------------------------------- | ----------- | ---------- |
| time_from_millis | query        | Время от в миллисекундах (включительно) | Да          | long       |
| time_to_millis   | query        | Время до в миллисекундах (включительно) | Да          | long       |
| devices            | query        | Фильтровать по устройствам              | Нет         | [ string ] |
| countries          | query        | Фильтровать по странам                  | Нет         | [ string ] |

##### Ответы

| Код | Описание                       |
| --- | ------------------------------ |
| 200 | Получена статистика по доменам |
| 400 | Ошибка проверки                |

### /oapi/v1/stats/time

#### GET

##### Что делает

Получает статистику по времени

##### Параметры

| Имя                | Расположен в | Описание                                | Обязательно | Схема      |
| ------------------ | ------------ | --------------------------------------- | ----------- | ---------- |
| time_from_millis | query        | Время от в миллисекундах (включительно) | Да          | long       |
| time_to_millis   | query        | Время до в миллисекундах (включительно) | Да          | long       |
| devices            | query        | Фильтровать по устройствам              | Нет         | [ string ] |
| countries          | query        | Фильтровать по странам                  | Нет         | [ string ] |

##### Ответы

| Код | Описание                       |
| --- | ------------------------------ |
| 200 | Получена статистика по времени |
| 400 | Ошибка проверки                |

### /oapi/v1/web_services

#### GET

##### Что делает

Перечисляет веб-службы

##### Ответы

| Код | Описание         |
| --- | ---------------- |
| 200 | Список веб-служб |
